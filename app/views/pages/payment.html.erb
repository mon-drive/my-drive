
    <style>
    .btn-toggle {
      width: 100%;
      padding: 20px;
      font-size: 18px;
      text-align: center;
      border: 2px solid #007bff;
      border-radius: 0.375rem;
      margin-bottom: 10px;
      cursor: pointer;
    }

    .btn-toggle.active {
      background-color: #007bff;
      color: white;
      border-color: #007bff;
    }

    .btn-toggle:hover {
      background-color: #0056b3;
      color: white;
    }

    .btn-toggle .price {
      display: block;
      font-size: 24px;
      font-weight: bold;
    }

    .btn-separator {
      border-left: 2px solid #333;
      height: 100%;
    }
  </style>
  <div class="container mt-4">
    <div class="row">
      <!-- Parte sinistra: Dati di pagamento -->
      <div class="col-md-8">
        <h2>Pagamento</h2>

        <!-- Verifica se il piano è gratuito e adatta la visualizzazione -->
        <% if @plan == 'free' %>
          <div class="alert alert-info" role="alert">
            Il piano gratuito non richiede pagamento. Completa l'iscrizione cliccando su "Paga".
          </div>
        <% else %>
          <!-- Selezione del piano e frequenza -->
          <div class="mb-3">
            <h4>Seleziona la frequenza di pagamento</h4>
            <div class="d-flex">
              <div class="btn-toggle" id="monthly_btn" data-value="monthly">
                Fatturazione Mensile
                <span class="price">9.99€</span>
              </div>
              <div class="btn-separator"></div>
              <div class="btn-toggle" id="annual_btn" data-value="annual">
                Fatturazione Annuale
                <span class="price">99.00€</span>
              </div>
            </div>
          </div>

          <!-- Opzioni di pagamento -->
          <div class="mb-4">
            <h4>Metodo di pagamento</h4>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="payment_method" id="credit_card" value="credit_card" checked>
              <label class="form-check-label" for="credit_card">
                Pagamento con Carta
              </label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="payment_method" id="paypal" value="paypal">
              <label class="form-check-label" for="paypal">
                Pagamento con PayPal
              </label>
            </div>
          </div>

          <!-- Form di pagamento con carta -->
          <div id="credit_card_form" class="payment-form">
            <h4>Dettagli della carta</h4>
            <form>
              <div class="form-group">
                <label for="card_number">Numero della carta</label>
                <input type="text" class="form-control" id="card_number" placeholder="Numero della carta">
              </div>
              <div class="form-row">
                <div class="form-group col-md-8">
                  <label for="card_expiry">Data di scadenza</label>
                  <input type="text" class="form-control" id="card_expiry" placeholder="MM/YY">
                </div>
                <div class="form-group col-md-4">
                  <label for="card_cvc">CVC</label>
                  <input type="text" class="form-control" id="card_cvc" placeholder="CVC">
                </div>
              </div>
            </form>
          </div>

          <!-- Pulsante di pagamento PayPal -->
          <div id="paypal_button" class="payment-form" style="display: none;">
            <h4>Pagamento PayPal</h4>
            <a href="https://www.paypal.com" class="btn btn-primary">Paga con PayPal</a>
          </div>
        <% end %>
      </div>

      <!-- Separatore verticale -->
      <div class="col-md-1">
        <div class="btn-separator"></div>
      </div>

      <!-- Parte destra: Resoconto del pagamento -->
      <div class="col-md-3">
        <h2>Resoconto</h2>
        <div class="border p-3 mb-3">
          <h4>Piano MyDrive</h4>
          <p><strong><%= @plan == 'premium' ? 'Premium' : 'Free' %></strong></p>
          <% if @plan != 'free' %>
            <h5>Totale</h5>
            <p id="total_amount"><strong>9.99€</strong></p>
          <% end %>
          <!-- Pulsante "Paga" per piani a pagamento -->
            <form method="post" action="<%= payment_complete_path %>">
                <input type="hidden" name="plan" value="<%= @plan %>">
                <button type="submit" class="btn btn-primary">Paga</button>
            </form>
        </div>
      </div>
    </div>
  </div>

  <!-- JavaScript per gestire la visibilità del form di pagamento e la selezione dei pulsanti -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script>
    $(document).ready(function() {
      // Gestione della selezione dei pulsanti di frequenza
      $('.btn-toggle').click(function() {
        $('.btn-toggle').removeClass('active');
        $(this).addClass('active');
        var selectedFrequency = $(this).data('value');
        var total = selectedFrequency === 'monthly' ? '9.99€' : '99.00€';
        $('#total_amount').text(total);
      });

      // Mostra/Nascondi form di pagamento e aggiorna il totale
      $('input[name="payment_method"]').change(function() {
        if ($(this).val() === 'credit_card') {
          $('#credit_card_form').show();
          $('#paypal_button').hide();
        } else if ($(this).val() === 'paypal') {
          $('#credit_card_form').hide();
          $('#paypal_button').show();
        }
      });

      // Imposta il valore predefinito per la frequenza di pagamento
      $('.btn-toggle').first().click();  // Clicca il primo pulsante per impostare il totale iniziale
    });
  </script>
